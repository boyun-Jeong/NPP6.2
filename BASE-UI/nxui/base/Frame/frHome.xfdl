<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="frHome_D" left="0" top="0" width="1920" height="800" onload="form_onload" onsize="frHome_D_onsize" onrbuttonup="frHome_D_onrbuttonup" scrollbarsize="15" scrollbarincbuttonsize="15" scrollbardecbuttonsize="15" scrollbartype="auto auto">
    <Layouts>
      <Layout>
        <Div id="divScrn" taborder="1" left="0" top="0" async="false" width="1905" height="800"/>
        <Div id="divBottom" taborder="1" text="div00" left="0" height="52" background="#dfdfdf" width="1920" top="839" visible="false">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="0" text="Copyright ⓒ Wemb SPP(Smart Portal Platform) All Reserved." left="40" font="13px 'KoPubL'" verticalAlign="middle" top="5" right="40" bottom="5" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn00" taborder="2" text="btn00" left="5" top="5" width="120" height="32" onclick="btn00_onclick" visible="false"/>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[/***********************************************************************************
* 화면(ID)		︰ frTop_D01
* 화면(명)		︰ 언어선택 div
* 메뉴(경로)	︰ Frame
* 화면 설명	︰ frTop 언어선택 Div
* 작성자		︰ WEMB
* 작성일		︰ 2023.04.06
* 수정이력		︰
*------------------------------------------------------------------
* 수정일        작성자		이력
*------------------------------------------------------------------
* 2023.04.06	 WEMB			최초작성
*------------------------------------------------------------------
* Description
***********************************************************************************/

/***********************************************************************************
 * Script Include 
 ***********************************************************************************/

/***********************************************************************************
 * Form Variable
 ***********************************************************************************/
this.objApp = nexacro.getApplication();
this.formObj;
/***********************************************************************************
 * Form Function
 ***********************************************************************************/ 
this.form_onload = function(obj:Form, e:nexacro.LoadEventInfo) 
{
}

this.fnInit = function(screenUrl)
{
	this.formObj = obj;
	this.divScrn.set_url(screenUrl);
// 	if(screenUrl == this.divScrn.url) {
// 		this.divScrn.set_url(screenUrl);
// 	}
// 	else {
// 		this.divScrn.form.fnSearch();
// 	}
	this.frHome_D_onsize();
}

/***********************************************************************************
 * Common Function
 ***********************************************************************************/

/***********************************************************************************
 * CallBack Event 
 ***********************************************************************************/
// Transaction 디폴트 콜백함수
this.fnCallback = function (sSvcId, nErrorCode, sErrorMsg)
{
	// 에러메세지 처리
	if (nErrorCode < 0) 
	{
		Ex.core.error(this,{id:"ERROR",msg:sSvcId+"\n"+Ex.core.msg(sErrorMsg)});
		return;
	}
			
	// 각 Transaction별 CallBack 처리
	switch (sSvcId)
	{
		case "" :
			break;
	}
}

/***********************************************************************************
 * User Function
 ***********************************************************************************/
// Toast 관련 함수
// Toast message 처리용
this.nToastCnt = 0;  // ID 및 Top 처리용
this.arrToast = []; // Top 처리시 참조용

this.fnSetMsgToast = function(strMsg, optArr)
{
	var tID = '';
	if( Ex.isEmpty(strMsg) ) strMsg = '';
	if( Ex.isEmpty(tID) ) tID = this.name +'_pToast' + this.nToastCnt;
	
	//trace("tID:" + tID);
	var pToast = this[tID];
	
	// option NVL
	if( Ex.isEmpty(optArr) )	optArr = {};
	var displaySecond 	= Ex.isNvl(optArr.displaySecond, 2);
	var usedecorate 	= Ex.isNvl(optArr.usedecorate, true);
	var toastType 		= Ex.isNvl(optArr.toastType, 'N');
	
	// CSS setting
	var css = '';
	switch(toastType.toUpperCase)
	{
		case "S" :	css = "sta_TOAST_success";	break;		// SUCCESS
		case "W" :	css = "sta_TOAST_warning";	break;		// WARNING
		case "E" :	css = "sta_TOAST_error";	break;		// ERROR
		default	:	css = "sta_TOAST_normal";	break;		// NORMAL
	}
	
	// toast begin
	var MIN_DISPLAY_SEC = 2;
	var MAX_DISPLAY_SEC = 10;
	var MIN_WIDTH = 250;
	var MAX_WIDTH = 800;
	
	var tempStatic = new Static("tempStatic", 0, 0, 0, 0, null, null);
	tempStatic.set_cssclass(css);
	
	if( usedecorate )
	{
		tempStatic.set_usedecorate(true);
	}
	
	tempStatic.set_text(strMsg);

	this.addChild("tempStatic", tempStatic);
	tempStatic.show();
	
	// toast width
	var objStaticSize = nexacro.getTextSize(tempStatic.getDisplayText(), tempStatic._getCurrentStyleInheritValue("font"));
	var objmax = parseInt(objStaticSize.nx) + 50;
	if(objmax <= MIN_WIDTH)	objmax = MIN_WIDTH;
	if(objmax >= MAX_WIDTH)	objmax = MAX_WIDTH;
	
	this.removeChild("tempStatic", tempStatic);
	tempStatic.destroy();

	var nLeft = (this.getOffsetWidth() / 2) - (objmax / 2);
	var nTop = 20 + (this.nToastCnt * 36);
	this.nToastCnt++;
	var oDiv = new Div(tID, nLeft, nTop, objmax, 36);
	oDiv.set_async(false);
	
	this.addChild(tID, oDiv);
	oDiv.msg = strMsg;
	
	// toast display time
	displaySecond = nexacro.toNumber(displaySecond, 0);
	if(displaySecond == MIN_DISPLAY_SEC)	displaySecond = MIN_DISPLAY_SEC;	// defualt 2초
	if(displaySecond > MAX_DISPLAY_SEC) 	displaySecond = MAX_DISPLAY_SEC;	// max 10초

	oDiv.displaySecond	= displaySecond;	// 표기할 시간(초)
	oDiv.isDecorate 	= usedecorate;		// default usedecorate true
	oDiv.toastType 		= toastType;		// defualt Type 'N'	- Normal
	oDiv.set_url("comm::comMsg.xfdl");
	oDiv.show();

	this.arrToast.push(oDiv);
}

// Toast message 삭제용
this.fnSetDestroy = function()
{
	//trace("frWork this.fnSetDestroy()");
	var rtn = this.removeChild(this.arrToast[0].id);
	var bSucc = this.arrToast[0].destroy();

	this.arrToast.splice(0,1);
	if( this.arrToast.length == 0 )
		this.nToastCnt = 0;
}







/***********************************************************************************
 * Component Event
 ***********************************************************************************/
this.frHome_D_onsize = function(obj:nexacro.Form,e:nexacro.SizeEventInfo)
{
	if(this.hscrollbar)
	{
		//trace("1111 this.hscrollbar.pos : " + this.hscrollbar.pos);
		if(this.hscrollbar.pos > 0)
		{
			this.hscrollbar.set_pos(0);
		}
		//trace("2222 this.hscrollbar.pos : " + this.hscrollbar.pos);
	}

	trace("[frHome_D_onsize] objApp.MAIN_HOME.width : " + this.objApp.MAIN_HOME.width + " objApp.MAIN_HOME.height: " + this.objApp.MAIN_HOME.height);
	
	var scrnWidth = this.divScrn.form.getLayoutInfo("default", "width");
	var scrnHeight = this.divScrn.form.getLayoutInfo("default", "height");

	var totWidth = this.getOwnerFrame().width;
	var totHeight = this.getOwnerFrame().height;
	
	this.set_width(totWidth);
	this.set_height(totHeight);

	var left = (totWidth - scrnWidth) / 2;
	trace("totWidth : " + totWidth + " scrnWidth : " + scrnWidth + " left: " + left + " totHeight: " + totHeight + " scrnHeight : " + scrnHeight);

	this.divBottom.set_width(0);
	this.resetScroll();

	if(left >= 0)
	{
		trace("if");
		this.divScrn.set_left(left);
		
		var scroll = 0;
		if(this.vscrollbar)	scroll = this.vscrollbar.max;
		trace("scroll : " + scroll);
		if(scroll > 0)
		{
			this.divBottom.set_width(this.getOwnerFrame().width - 15);
		}
		else
		{
			this.divBottom.set_width(this.getOwnerFrame().width);
		}
	}
	else
	{
		trace("else");
		this.divScrn.set_left(0);
		//this.divBottom.set_width(1920);
		var scroll = 0;
		if(this.vscrollbar)	scroll = this.vscrollbar.max;
		
		trace("scroll : " + scroll);
		if(scroll > 0)
		{
			this.divBottom.set_width(1920 - 15);
		}
		else
		{
			this.divBottom.set_width(1920);
		}
	}
	
	//this.resetScroll();
	
	var add = this.hscrollbar.max;
	trace("this.getOwnerFrame().width : " + this.getOwnerFrame().width + " this.width : " + this.width + " this.divScrn.left : " + this.divScrn.left + " this.divScrn.width : " + this.divScrn.width + " this.divBottom.width : " + this.divBottom.width + " add : " + add);
	//this.divBottom.set_width(this.divScrn.set_width - this.getOwnerFrame().width);

	if(nexacro.toNumber(this.divScrn.height) + nexacro.toNumber(this.divBottom.height) > totHeight)
	{
		this.divBottom.set_bottom(null);
		this.divBottom.set_height(52);
		this.divBottom.set_top(this.divScrn.height);
	}
	else
	{
		this.divBottom.set_top(null);
		this.divBottom.set_height(52);
		this.divBottom.set_bottom(0);
	}
	
	this.resetScroll();
	
	this.objApp.MAIN_HOME.form.resetScroll();
	
	// 폼 로드 시 필요한 기술사항은 this.fnInit에서 기술할 것.
	//trace("workArea form init call :: WebSocketTest");
	//this.objApp.connect(this.objApp.MAIN_HOME.form);	//연결
};

this.btn00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var scrnWidth = this.divScrn.form.getLayoutInfo("default", "width");
	var scrnHeight = this.divScrn.form.getLayoutInfo("default", "height");
	var left = (this.getOwnerFrame().width - scrnWidth) / 2;
	
	trace("left : " + left);
	trace("this.getOwnerFrame().width : " + this.getOwnerFrame().width);
	trace("this.getOwnerFrame().height : " + this.getOwnerFrame().height);
	trace("this.width : " + this.width);
	trace("this.height : " + this.height);
	trace("this.divScrn.width : " + this.divScrn.width);
	trace("this.divScrn.height : " + this.divScrn.height);
	if(this.hscrollbar)
	{
		trace("this.hscrollbar.max : " + this.hscrollbar.max);
	}
	if(this.vscrollbak)
	{
		trace("this.vscrollbak.max : " + this.vscrollbak.max);
	}
	trace("this.divBottom.width : " + this.divBottom.width);
	trace("this.divBottom.height : " + this.divBottom.height);
};

this.frHome_D_onrbuttonup = function(obj:nexacro.Form,e:nexacro.MouseEventInfo)
{
	if(e.ctrlkey && e.shiftkey) this.btn00.set_visible(!this.btn00.visible);
};]]></Script>
    <Objects>
      <Dataset id="dsLangCd"/>
    </Objects>
  </Form>
</FDL>
