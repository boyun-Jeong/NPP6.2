<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.base.fomm.dao.FOMM0251WDAO">
    
    <!-- SPP 게시글 조회 (트리 계층 구조) -->
    <select id="select01" parameterType="java.util.Map" resultType="java.util.Map">
        /* FOMM0251WMapper >> select01 */
        WITH 
        pre_tb AS (
            SELECT    '0' AS CHK
                    , '' AS ROWFLAG
                    , POST_DT_NO      --게시글번호
                    , UP_POST_DT_NO   --상위게시글번호
                    , (SELECT D.TITLE FROM FOMM_POST_DT D WHERE D.POST_DT_NO = A.UP_POST_DT_NO) AS UP_POST_DT_TITLE
                    , SUBSTR(SYS_CONNECT_BY_PATH(LPAD(TO_CHAR(A.POST_DT_NO), 6, '0') , '/') ,2) AS DEPTH_POST_DT_NO --계층파악코드
                    , LEVEL -1 AS ORI_LVL -- 트리 레벨
                    , POST_MT_TYPE_CD --게시글구분코드
                    , (SELECT CD.CMM_CD_NM FROM FOMM_CMM_CD_MT CD WHERE CD.UP_CMM_CD = 'POST_MT_TYPE_CD' AND CD.CODE_DIV = 'CMM_CD' AND CD.CMM_CD = POST_MT_TYPE_CD) AS POST_MT_TYPE_NM --게시글구분코드명
                    , DAT_TYPE_CD   --자료구분코드
                    , (SELECT CD.CMM_CD_NM FROM FOMM_CMM_CD_MT CD WHERE CD.UP_CMM_CD = 'DAT_TYPE_CD' AND CD.CODE_DIV = 'CMM_CD' AND CD.CMM_CD = DAT_TYPE_CD) AS DAT_TYPE_NM --자료구분코드
                    , TITLE --제목
                    , CONTS --내용
                    , NTC_YN
                    , DEL_YN    --삭제여부
                    , READ_CNT  --조회수
                    , ( SELECT  COUNT(*) 
                        FROM FOMM_COMMENT_MT
                        WHERE DEL_YN = 'N' 
                        AND KEY_TBL = 'FOMM_POST_DT' 
                        AND PK1 = A.POST_DT_NO
                      ) AS COMMENT_CNT
                    , NVL(( SELECT  'Y' 
                            FROM    FOMM_ATCHFILE_MT
                            WHERE   KEY_TBL = 'FOMM_POST_DT'
                            AND     PK1     = TO_CHAR(A.POST_DT_NO)
                            AND     DEL_YN = 'N'
                            AND     ROWNUM  = 1
                        ), 'N') AS ATCHFILE_YN
                    , RMK   --비고
                    , FRID  --최초등록자
                    , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = A.FRID) AS FRNM
                    , (SELECT DEPT_NM FROM FOMM_USER_MT WHERE USER_ID = A.FRID) AS FR_DEPT_NM
                    , FRDT  --최초등록일시
                    , LMID  --최종수정자
                    , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = A.LMID) AS LMNM
                    , LMDT  --최종수정일시
                    , LMPID --최종수정화면ID
                    , POST_TMPL_ID --템플릿ID
                    , POST_MT_NO --게시판 번호
                    , (SELECT TITLE FROM FOMM_POST_MT  WHERE POST_MT_NO = A.POST_MT_NO) AS POST_MT_TITLE -- 게시판명
                    , (SELECT POST_TMPL FROM FOMM_POST_MT  WHERE POST_MT_NO = A.POST_MT_NO) AS POST_TMPL_LIST --템플릿 리스트
                    , SVC_CLSS_CD
                    , BSE_LVL2_CD
                    , UPMU_ID1
                    , UPMU_ID2
                    , PL_ID
                    , PL_NM
                    , connect_by_isleaf leaf_yn
            FROM    FOMM_POST_DT A
            WHERE     1=1
            START WITH UP_POST_DT_NO IS NULL -- 최상위 노드
            CONNECT BY PRIOR POST_DT_NO = UP_POST_DT_NO -- 부모-자식 관계 정의
            ORDER SIBLINGS BY POST_DT_NO DESC --같은 부모의 형제 노드 최신순 정렬
        ),
        main_tb as (
        select CHK, ROWFLAG, POST_DT_NO, UP_POST_DT_NO, UP_POST_DT_TITLE,
			DEPTH_POST_DT_NO, ORI_LVL, POST_MT_TYPE_CD, POST_MT_TYPE_NM, DAT_TYPE_CD,
			DAT_TYPE_NM, CASE WHEN del_yn = 'Y' THEN '(삭제글)' ELSE TITLE END AS TITLE, CONTS, NTC_YN, DEL_YN, 
			READ_CNT, COMMENT_CNT, ATCHFILE_YN, RMK, FRID, 
			FRNM, FR_DEPT_NM, FRDT, LMID, LMNM,
			LMDT, LMPID, POST_TMPL_ID, POST_TMPL_LIST, POST_MT_NO, POST_MT_TITLE, 
			SVC_CLSS_CD, BSE_LVL2_CD, UPMU_ID1, UPMU_ID2, PL_ID,
			PL_NM, leaf_yn
		from pre_tb 
        ),
        main_ntc_tb AS (
        /* 공지글 상단 올림 */
        SELECT 'Y' AS NTC_ADD_YN, 0 AS LVL,
               n.* 
          FROM main_tb n
         WHERE NTC_YN = 'Y'
            <if test="POST_MT_NO != '' and POST_MT_NO != null">
                AND POST_MT_NO = #{POST_MT_NO}
            </if>
         UNION ALL 
        /* 공지글 포함 전체글 */ 
        SELECT 'N' AS NTC_ADD_YN, ORI_LVL AS LVL,
               a.* 
          FROM main_tb a
        WHERE 1=1
            <if test="POST_MT_NO != '' and POST_MT_NO != null">
                AND POST_MT_NO = #{POST_MT_NO}
            </if>
        <choose>
            <when test="POST_DT_NO != null and POST_DT_NO != '' ">
                AND POST_DT_NO = #{POST_DT_NO}
            </when> 
            <when test="(POST_MT_NO != null and POST_MT_NO != '')
                    or (POST_MT_TYPE_CD != null and POST_MT_TYPE_CD != '')
                    or (TITLE != null and TITLE != '')
                    or (NTC_YN != null and NTC_YN != '')
                    or (POST_TMPL_ID != null and POST_TMPL_ID != '')
                    or (POST_YN != null and POST_YN == 'Y')">
               and POST_DT_NO IN (
                    SELECT POST_DT_NO /*상위 게시글*/
                    FROM FOMM_POST_DT
                    START WITH 
                    ( 1=1                    
                    <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                        AND POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                    </if>
                    <if test="TITLE != '' and TITLE != null">
                        AND UPPER(TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                    </if>
                    <if test="NTC_YN != '' and NTC_YN != null">
                        AND NTC_YN = #{NTC_YN}
                    </if>
                    <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                        AND POST_TMPL_ID = #{POST_TMPL_ID}
                    </if>
                    )
                    CONNECT BY nocycle PRIOR UP_POST_DT_NO = POST_DT_NO
                  UNION 
                    SELECT POST_DT_NO /*하위 게시글*/
                    FROM FOMM_POST_DT 
                    START WITH 
                    ( 1=1
                    <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                        AND POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                    </if>
                    <if test="TITLE != '' and TITLE != null">
                        AND UPPER(TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                    </if>
                    <if test="NTC_YN != '' and NTC_YN != null">
                        AND NTC_YN = #{NTC_YN}
                    </if>
                    <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                        AND POST_TMPL_ID = #{POST_TMPL_ID}
                    </if>
                    )
                    CONNECT BY nocycle PRIOR POST_DT_NO = UP_POST_DT_NO
                )
            </when>
        </choose> 
        ),
		FOR_DEL_TOPDOWN_TB AS (  /* TOP DOWN 전체 쿼리 */
			SELECT POST_DT_NO, UP_POST_DT_NO, TITLE, DEL_YN, SYS_CONNECT_BY_PATH(DEL_YN, '/') DEL_PATH,
			       SYS_CONNECT_BY_PATH(POST_DT_NO, '/') FULL_PATH, CONNECT_BY_ISLEAF LEAF_FLAG
			FROM FOMM_POST_DT P 
			WHERE 1=1
			<if test="POST_MT_NO != '' and POST_MT_NO != null">
                AND POST_MT_NO = #{POST_MT_NO}
            </if>
			CONNECT BY PRIOR POST_DT_NO = UP_POST_DT_NO
			START WITH UP_POST_DT_NO IS NULL
		),
		FOR_DEL_BOTTOMUP_TB AS ( /* BOTTOM UP 전체 쿼리, 단, STARTWITH 를 LEAF 에서 진행함 */
			SELECT POST_DT_NO, UP_POST_DT_NO, TITLE, DEL_YN, SYS_CONNECT_BY_PATH(DEL_YN, '/') DEL_PATH,
			       SYS_CONNECT_BY_PATH(POST_DT_NO, '/') FULL_PATH, CONNECT_BY_ISLEAF LEAF_FLAG
			FROM FOMM_POST_DT P
			WHERE 1=1
			<if test="POST_MT_NO != '' and POST_MT_NO != null">
                AND POST_MT_NO = #{POST_MT_NO}
            </if>
			CONNECT BY NOCYCLE POST_DT_NO = PRIOR UP_POST_DT_NO
			START WITH POST_DT_NO IN (SELECT POST_DT_NO FROM FOR_DEL_TOPDOWN_TB WHERE LEAF_FLAG = 1)
		),
		FOR_DEL_LIVE_TB AS (  /* N 이 하나라도 있으면 살아있는 게시글 */
			SELECT * FROM FOR_DEL_BOTTOMUP_TB 
			WHERE DEL_PATH LIKE '%N%'
		)
        SELECT * FROM MAIN_NTC_TB 
        WHERE 1=1
        AND POST_DT_NO IN (SELECT POST_DT_NO FROM FOR_DEL_LIVE_TB)
        <if test="NTC_ADD_YN != '' and NTC_ADD_YN != null">
            AND NTC_ADD_YN = #{NTC_ADD_YN}
        </if>
        <if test="SDATE != '' and SDATE != null and EDATE != '' and EDATE != null">
            AND SUBSTR(FRDT, 0, 8) BETWEEN #{SDATE} AND #{EDATE}
        </if>
  
    </select>
    
    <!-- SPP 게시글 조회 (트리 계층 구조) -->
    <select id="select01_backup0410" parameterType="java.util.Map" resultType="java.util.Map">
        /* FOMM0251WMapper >> select01 */
        WITH 
        pre_tb AS (
            SELECT    '0' AS CHK
                    , '' AS ROWFLAG
                    , POST_DT_NO      --게시글번호
                    , UP_POST_DT_NO   --상위게시글번호
                    , (SELECT D.TITLE FROM FOMM_POST_DT D WHERE D.POST_DT_NO = A.UP_POST_DT_NO) AS UP_POST_DT_TITLE
                    , SUBSTR(SYS_CONNECT_BY_PATH(LPAD(TO_CHAR(A.POST_DT_NO), 6, '0') , '/') ,2) AS DEPTH_POST_DT_NO --계층파악코드
                    , LEVEL -1 AS ORI_LVL -- 트리 레벨
                    , POST_MT_TYPE_CD --게시글구분코드
                    , (SELECT CD.CMM_CD_NM FROM FOMM_CMM_CD_MT CD WHERE CD.UP_CMM_CD = 'POST_MT_TYPE_CD' AND CD.CODE_DIV = 'CMM_CD' AND CD.CMM_CD = POST_MT_TYPE_CD) AS POST_MT_TYPE_NM --게시글구분코드명
                    , DAT_TYPE_CD   --자료구분코드
                    , (SELECT CD.CMM_CD_NM FROM FOMM_CMM_CD_MT CD WHERE CD.UP_CMM_CD = 'DAT_TYPE_CD' AND CD.CODE_DIV = 'CMM_CD' AND CD.CMM_CD = DAT_TYPE_CD) AS DAT_TYPE_NM --자료구분코드
                    , TITLE --제목
                    , CONTS --내용
                    , NTC_YN
                    , DEL_YN    --삭제여부
                    , READ_CNT  --조회수
                    , ( SELECT  COUNT(*) 
                        FROM FOMM_COMMENT_MT
                        WHERE DEL_YN = 'N' 
                        AND KEY_TBL = 'FOMM_POST_DT' 
                        AND PK1 = A.POST_DT_NO
                      ) AS COMMENT_CNT
                    , NVL(( SELECT  'Y' 
                            FROM    FOMM_ATCHFILE_MT
                            WHERE   KEY_TBL = 'FOMM_POST_DT'
                            AND     PK1     = TO_CHAR(A.POST_DT_NO)
                            AND     DEL_YN = 'N'
                            AND     ROWNUM  = 1
                        ), 'N') AS ATCHFILE_YN
                    , RMK   --비고
                    , FRID  --최초등록자
                    , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = A.FRID) AS FRNM
                    , (SELECT DEPT_NM FROM FOMM_USER_MT WHERE USER_ID = A.FRID) AS FR_DEPT_NM
                    , FRDT  --최초등록일시
                    , LMID  --최종수정자
                    , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = A.LMID) AS LMNM
                    , LMDT  --최종수정일시
                    , LMPID --최종수정화면ID
                    , POST_TMPL_ID --템플릿ID
                    , POST_MT_NO --게시판 번호
                    , (SELECT TITLE FROM FOMM_POST_MT  WHERE POST_MT_NO = A.POST_MT_NO) AS POST_MT_TITLE -- 게시판명
                    , (SELECT POST_TMPL FROM FOMM_POST_MT  WHERE POST_MT_NO = A.POST_MT_NO) AS POST_TMPL_LIST --템플릿 리스트
                    , SVC_CLSS_CD
                    , BSE_LVL2_CD
                    , UPMU_ID1
                    , UPMU_ID2
                    , PL_ID
                    , PL_NM
                    , connect_by_isleaf leaf_yn
            FROM    FOMM_POST_DT A
            WHERE     1=1
            START WITH UP_POST_DT_NO IS NULL -- 최상위 노드
            CONNECT BY PRIOR POST_DT_NO = UP_POST_DT_NO -- 부모-자식 관계 정의
            ORDER SIBLINGS BY POST_DT_NO DESC --같은 부모의 형제 노드 최신순 정렬
        ),
        main_tb as (
        select CHK, ROWFLAG, POST_DT_NO, UP_POST_DT_NO, UP_POST_DT_TITLE,
			DEPTH_POST_DT_NO, ORI_LVL, POST_MT_TYPE_CD, POST_MT_TYPE_NM, DAT_TYPE_CD,
			DAT_TYPE_NM, CASE WHEN del_yn = 'Y' THEN '(삭제글)' ELSE TITLE END AS TITLE, CONTS, NTC_YN, DEL_YN, 
			READ_CNT, COMMENT_CNT, ATCHFILE_YN, RMK, FRID, 
			FRNM, FR_DEPT_NM, FRDT, LMID, LMNM,
			LMDT, LMPID, POST_TMPL_ID, POST_TMPL_LIST, POST_MT_NO, POST_MT_TITLE, 
			SVC_CLSS_CD, BSE_LVL2_CD, UPMU_ID1, UPMU_ID2, PL_ID,
			PL_NM, leaf_yn
		from pre_tb 
        where NOT ( leaf_yn = 1 AND del_yn = 'Y') 
        ),
        main_ntc_tb AS (
        /* 공지글 상단 올림 */
        SELECT 'Y' AS NTC_ADD_YN, 0 AS LVL,
               n.* 
          FROM main_tb n
         WHERE NTC_YN = 'Y'
            <if test="POST_MT_NO != '' and POST_MT_NO != null">
                AND POST_MT_NO = #{POST_MT_NO}
            </if>
         UNION ALL 
        /* 공지글 포함 전체글 */ 
        SELECT 'N' AS NTC_ADD_YN, ORI_LVL AS LVL,
               a.* 
          FROM main_tb a
        WHERE 1=1
            <if test="POST_MT_NO != '' and POST_MT_NO != null">
                AND POST_MT_NO = #{POST_MT_NO}
            </if>
        <choose>
            <when test="POST_DT_NO != null and POST_DT_NO != '' ">
                AND POST_DT_NO = #{POST_DT_NO}
            </when> 
            <when test="(POST_MT_NO != null and POST_MT_NO != '')
                    or (POST_MT_TYPE_CD != null and POST_MT_TYPE_CD != '')
                    or (TITLE != null and TITLE != '')
                    or (NTC_YN != null and NTC_YN != '')
                    or (POST_TMPL_ID != null and POST_TMPL_ID != '')
                    or (POST_YN != null and POST_YN == 'Y')">
               and POST_DT_NO IN (
                    SELECT POST_DT_NO /*상위 게시글*/
                    FROM FOMM_POST_DT
                    START WITH 
                    ( 1=1                    
                    <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                        AND POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                    </if>
                    <if test="TITLE != '' and TITLE != null">
                        AND UPPER(TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                    </if>
                    <if test="NTC_YN != '' and NTC_YN != null">
                        AND NTC_YN = #{NTC_YN}
                    </if>
                    <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                        AND POST_TMPL_ID = #{POST_TMPL_ID}
                    </if>
                    )
                    CONNECT BY nocycle PRIOR UP_POST_DT_NO = POST_DT_NO
                  UNION 
                    SELECT POST_DT_NO /*하위 게시글*/
                    FROM FOMM_POST_DT 
                    START WITH 
                    ( 1=1
                    <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                        AND POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                    </if>
                    <if test="TITLE != '' and TITLE != null">
                        AND UPPER(TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                    </if>
                    <if test="NTC_YN != '' and NTC_YN != null">
                        AND NTC_YN = #{NTC_YN}
                    </if>
                    <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                        AND POST_TMPL_ID = #{POST_TMPL_ID}
                    </if>
                    )
                    CONNECT BY nocycle PRIOR POST_DT_NO = UP_POST_DT_NO
                )
            </when>
        </choose> 
        ) 
        SELECT * FROM main_ntc_tb 
        WHERE 1=1
        <if test="NTC_ADD_YN != '' and NTC_ADD_YN != null">
            AND NTC_ADD_YN = #{NTC_ADD_YN}
        </if>
        <if test="SDATE != '' and SDATE != null and EDATE != '' and EDATE != null">
            AND SUBSTR(FRDT, 0, 8) BETWEEN #{SDATE} AND #{EDATE}
        </if>
  
    </select>
    
    <!-- SPP 게시판 조회 (트리 계층 구조) -->
    <select id="select02" parameterType="java.util.Map" resultType="java.util.Map">
        /* FOMM0251WMapper >> select02 */
        WITH main_tb AS (
            SELECT    '0' AS CHK
                , '' AS ROWFLAG
                , CREATE_TYPE     --생성타입
                , POST_MT_NO      --게시판번호
                , UP_POST_MT_NO   --상위게시판번호
                , (SELECT TITLE FROM FOMM_POST_MT WHERE POST_MT_NO = A.UP_POST_MT_NO) AS UP_POST_MT_NM --상위게시판명
                , SUBSTR(SYS_CONNECT_BY_PATH(A.POST_MT_NO, ','), 2)    AS DEPTH_POST_MT_NO -- 계층 파악 코드
                , LEVEL -1 AS LVL -- 트리 레벨
                , POST_MT_TYPE_CD --게시판구분코드
                , TITLE --제목
                , BEGIN_DT  --게시시작일시
                , SUBSTR(BEGIN_DT, 1, 8) AS BEGIN_DATE
                , SUBSTR(BEGIN_DT, 9, 4) AS BEGIN_TIME
                , END_DT    --게시종료일시
                , SUBSTR(END_DT, 1, 8) AS END_DATE
                , SUBSTR(END_DT, 9, 4) AS END_TIME
                , POST_MT_TYPE_NM --게시판구분코드명
                , DEL_YN    --삭제여부
                , RMK   --비고
                , FRID  --최초등록자
                , (SELECT B.USER_NM FROM FOMM_USER_MT B WHERE B.USER_ID = A.FRID) AS FRNM
                , (SELECT B.DEPT_NM FROM FOMM_USER_MT B WHERE B.USER_ID = A.FRID) AS FR_DEPT_NM
                , FRDT  --최초등록일시
                , LMID  --최종수정자
                , (SELECT B.USER_NM FROM FOMM_USER_MT B WHERE B.USER_ID = A.LMID) AS LMNM
                , LMDT  --최종수정일시
                , LMPID --최종수정화면ID
                , POST_TMPL --템플릿리스트
                , NVL(DEPT_NM, (SELECT B.DEPT_NM FROM FOMM_POST_MT B WHERE B.POST_MT_NO = A.UP_POST_MT_NO)) AS DEPT_NM --부서명
                , NVL(DEPT_CD, (SELECT B.DEPT_CD FROM FOMM_POST_MT B WHERE B.POST_MT_NO = A.UP_POST_MT_NO)) AS DEPT_CD --부서코드
                , AUTH_WRITE --쓰기권한
                , WRITE_GUBUN --쓰기구분
                , AUTH_READ --읽기권한
                , ATTACH_YN --파일첨부여부
                , ALARM_GUBUN --알림구분
                , MANAGER -- 관리자
                , SORT_ORDR -- 정렬순서
            FROM    FOMM_POST_MT A
            WHERE     1=1
            START WITH UP_POST_MT_NO IS NULL -- 최상위 노드
            CONNECT BY PRIOR POST_MT_NO = UP_POST_MT_NO -- 부모-자식 관계 정의
            ORDER SIBLINGS BY SORT_ORDR
        ) 
        SELECT * FROM main_tb
        where 1=1    
        <if test="DEL_YN != '' and DEL_YN != null">
            AND DEL_YN = #{DEL_YN}
        </if>
        <if test="POST_MT_NO != '' and POST_MT_NO != null">
            AND POST_MT_NO = #{POST_MT_NO}
        </if>
        and POST_MT_NO IN (
            SELECT POST_MT_NO /*상위 게시글*/
            FROM FOMM_POST_MT FPM
            START WITH 
            ( 1=1
                <if test="DEL_YN != '' and DEL_YN != null">
                    AND FPM.DEL_YN = #{DEL_YN}
                </if>
                <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                    AND FPM.POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                </if>
                <if test="TITLE != '' and TITLE != null">
                    AND UPPER(FPM.TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                </if>
                <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                    AND FPM.POST_TMPL_ID = #{POST_TMPL_ID}
                </if>
                <if test='DEPT_CD != "" and DEPT_CD != null and SYS_YN != null and "N".equals(SYS_YN)'>
                    AND FPM.BEGIN_DT <![CDATA[<=]]> TO_CHAR(SYSDATE, 'YYYYMMDD')||'000000'
					AND FPM.END_DT <![CDATA[>=]]> TO_CHAR(SYSDATE, 'YYYYMMDD')||'000000'
					AND (  EXISTS ( SELECT 1 FROM FOMM_DEPT_MT FDM
                                WHERE 1=1
                                AND FDM.DEPT_CD = #{DEPT_CD}
                                START WITH FDM.DEPT_CD = NVL(FPM.DEPT_CD, (SELECT B.DEPT_CD FROM FOMM_POST_MT B WHERE B.POST_MT_NO = FPM.UP_POST_MT_NO))
                                CONNECT BY PRIOR FDM.DEPT_CD = FDM.UP_DEPT_CD)
					OR FPM.AUTH_READ = 'ALL')
                </if>
            )
            CONNECT BY nocycle PRIOR FPM.UP_POST_MT_NO = FPM.POST_MT_NO
          UNION 
            SELECT POST_MT_NO /*하위 게시글*/
            FROM FOMM_POST_MT FPM
            START WITH 
            ( 1=1
                <if test="DEL_YN != '' and DEL_YN != null">
                    AND FPM.DEL_YN = #{DEL_YN}
                </if>
                <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                    AND FPM.POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                </if>
                <if test="TITLE != '' and TITLE != null">
                    AND UPPER(FPM.TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                </if>
                <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                    AND FPM.POST_TMPL_ID = #{POST_TMPL_ID}
                </if>
                <if test='DEPT_CD != "" and DEPT_CD != null and SYS_YN != null and "N".equals(SYS_YN)'>
                    AND FPM.BEGIN_DT <![CDATA[<=]]> TO_CHAR(SYSDATE, 'YYYYMMDD')||'000000'
					AND FPM.END_DT <![CDATA[>=]]> TO_CHAR(SYSDATE, 'YYYYMMDD')||'000000'
					AND (  EXISTS ( SELECT 1 FROM FOMM_DEPT_MT FDM
                                WHERE 1=1
                                AND FDM.DEPT_CD = #{DEPT_CD}
                                START WITH FDM.DEPT_CD = NVL(FPM.DEPT_CD, (SELECT B.DEPT_CD FROM FOMM_POST_MT B WHERE B.POST_MT_NO = FPM.UP_POST_MT_NO))
                                CONNECT BY PRIOR FDM.DEPT_CD = FDM.UP_DEPT_CD)
                   OR FPM.AUTH_READ = 'ALL')
                </if>
            )
            CONNECT BY nocycle PRIOR FPM.POST_MT_NO = FPM.UP_POST_MT_NO
        )
    </select>
    
    <!-- SPP 게시판 조회 (트리 계층 구조) -->
    <select id="select07" parameterType="java.util.Map" resultType="java.util.Map">
        /* FOMM0251WMapper >> select07 (select 02 팝업에서 띄움) */
        WITH main_tb AS (
            SELECT    '0' AS CHK
                , '' AS ROWFLAG
                , CREATE_TYPE     --생성타입
                , POST_MT_NO      --게시판번호
                , UP_POST_MT_NO   --상위게시판번호
                , (SELECT TITLE FROM FOMM_POST_MT WHERE POST_MT_NO = A.UP_POST_MT_NO) AS UP_POST_MT_NM --상위게시판명
                , SUBSTR(SYS_CONNECT_BY_PATH(A.POST_MT_NO, ','), 2)    AS DEPTH_POST_MT_NO -- 계층 파악 코드
                , LEVEL -1 AS LVL -- 트리 레벨
                , POST_MT_TYPE_CD --게시판구분코드
                , TITLE --제목
                , BEGIN_DT  --게시시작일시
                , SUBSTR(BEGIN_DT, 1, 8) AS BEGIN_DATE
                , SUBSTR(BEGIN_DT, 9, 4) AS BEGIN_TIME
                , END_DT    --게시종료일시
                , SUBSTR(END_DT, 1, 8) AS END_DATE
                , SUBSTR(END_DT, 9, 4) AS END_TIME
                , POST_MT_TYPE_NM --게시판구분코드명
                , DEL_YN    --삭제여부
                , RMK   --비고
                , FRID  --최초등록자
                , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = A.FRID) AS FRNM
                , (SELECT DEPT_NM FROM FOMM_USER_MT WHERE USER_ID = A.FRID) AS FR_DEPT_NM
                , FRDT  --최초등록일시
                , LMID  --최종수정자
                , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = A.LMID) AS LMNM
                , LMDT  --최종수정일시
                , LMPID --최종수정화면ID
                , POST_TMPL --템플릿리스트
                , NVL(DEPT_NM, (SELECT DEPT_NM FROM FOMM_POST_MT WHERE POST_MT_NO = A.UP_POST_MT_NO)) AS DEPT_NM --부서명
                , NVL(DEPT_CD, (SELECT DEPT_CD FROM FOMM_POST_MT WHERE POST_MT_NO = A.UP_POST_MT_NO)) AS DEPT_CD --부서코드
                , AUTH_WRITE --쓰기권한
                , WRITE_GUBUN --쓰기구분
                , AUTH_READ --읽기권한
                , ATTACH_YN --파일첨부여부
                , ALARM_GUBUN --알림구분
                , MANAGER -- 관리자
                , SORT_ORDR -- 정렬순서
            FROM    FOMM_POST_MT A
            WHERE     1=1
            START WITH UP_POST_MT_NO IS NULL -- 최상위 노드
            CONNECT BY PRIOR POST_MT_NO = UP_POST_MT_NO -- 부모-자식 관계 정의
        ) 
        SELECT * FROM main_tb
        where 1=1    
        <if test="DEL_YN != '' and DEL_YN != null">
            AND DEL_YN = #{DEL_YN}
        </if>
        <if test="POST_MT_NO != '' and POST_MT_NO != null">
            AND POST_MT_NO = #{POST_MT_NO}
        </if>
        and POST_MT_NO IN (
            SELECT POST_MT_NO /*상위 게시글*/
            FROM FOMM_POST_MT
            START WITH 
            ( 1=1
                <if test="DEL_YN != '' and DEL_YN != null">
                    AND DEL_YN = #{DEL_YN}
                </if>
                <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                    AND POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                </if>
                <if test="TITLE != '' and TITLE != null">
                    AND UPPER(TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                </if>
                <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                    AND POST_TMPL_ID = #{POST_TMPL_ID}
                </if>
            )
            CONNECT BY nocycle PRIOR UP_POST_MT_NO = POST_MT_NO
          UNION 
            SELECT POST_MT_NO /*하위 게시글*/
            FROM FOMM_POST_MT 
            START WITH 
            ( 1=1
                <if test="DEL_YN != '' and DEL_YN != null">
                    AND DEL_YN = #{DEL_YN}
                </if>
                <if test="POST_MT_TYPE_CD != '' and POST_MT_TYPE_CD != null">
                    AND POST_MT_TYPE_CD = #{POST_MT_TYPE_CD}
                </if>
                <if test="TITLE != '' and TITLE != null">
                    AND UPPER(TITLE) LIKE UPPER('%' || #{TITLE} || '%')
                </if>
                <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
                    AND POST_TMPL_ID = #{POST_TMPL_ID}
                </if>
            )
            CONNECT BY nocycle PRIOR POST_MT_NO = UP_POST_MT_NO
        )
        ORDER BY DEPTH_POST_MT_NO
    </select>

    <!-- SPP 게시판 종류 및 템플릿 조회 -->
    <select id="select03" parameterType="java.util.Map" resultType="java.util.Map">
        /* FOMM0251WMapper >> select03 */
        SELECT 
          M.POST_MT_NO
        , T.POST_TMPL_ID AS TMPL_ID
        , T.POST_TMPL_CD AS TMPL_CD
        , T.POST_TMPL_NM AS TMPL_CD_NM
        , T.CONTS AS CONTS
        FROM 
                FOMM_POST_MT M
            RIGHT OUTER JOIN
                FOMM_POST_TMPL T
            ON  ',' || M.POST_TMPL || ',' LIKE '%,' || T.POST_TMPL_CD || ',%'
        WHERE   1=1  
                AND   M.POST_MT_NO = #{POST_MT_NO}
        ORDER BY
                M.POST_MT_NO, T.POST_TMPL_CD
    </select>
    
    <!-- SPP IT 게시판 그리드 - 조회 -->
    <select id="selectEDU" parameterType="java.util.Map" resultType="java.util.Map">
    /* FOMM0251WMapper >> selectEDU */
    SELECT   '0' AS CHK
            , '' AS ROWFLAG
            , POST_DT_NO
            , SEQ
            , REQ_USER_ID
            , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = e.REQ_USER_ID) AS REQ_USER_NM
            , REQ_DEPT_ID
            , REQ_DEPT_NM
            , (SELECT TELNUM FROM FOMM_USER_MT WHERE USER_ID = e.REQ_USER_ID) AS TELNUM
            , EDU_TYPE_CD
            , EDU_NM
            , EDU_ORG_NM
            , EDU_CNT_NM
            , EDU_AMOUNT
            , DEL_YN
            , RMK
            , FRID
            , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = e.FRID) AS FRNM
            , FRDT
            , LMID
            , LMDT
            , LMPID
    FROM FOMM_POST_EDU_REQ e
    WHERE 1=1
                AND    DEL_YN = 'N'
            <if test="POST_DT_NO != '' and POST_DT_NO != null">
	            AND    POST_DT_NO = #{POST_DT_NO}
	        </if>
            <if test="SDATE != '' and SDATE != null and EDATE != '' and EDATE != null">
                AND SUBSTR(FRDT, 0, 8) BETWEEN #{SDATE} AND #{EDATE}
            </if>
    </select>
    
    <!-- SPP SW 게시판 그리드 - 조회 -->
    <select id="selectSW" parameterType="java.util.Map" resultType="java.util.Map">
	    /* FOMM0251WMapper >> selectSW */
	    SELECT      '0' AS CHK
	            , '' AS ROWFLAG
	            , S.POST_DT_NO
	            , S.SEQ
	            , S.REQ_USER_ID
	            , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = s.REQ_USER_ID) AS REQ_USER_NM
	            , S.REQ_DEPT_ID
	            , S.REQ_DEPT_NM
	            , (SELECT TELNUM FROM FOMM_USER_MT WHERE USER_ID = s.REQ_USER_ID) AS TELNUM
	            , S.SW_NM
	            , S.SW_CNT
	            , S.SW_AMT
	            , S.USE_PURPOSE
	            , S.SW_VENDOR_NM
	            , S.SW_USE_TYPE
	            , S.DEL_YN
	            , S.RMK
	            , S.FRID
	            , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = s.FRID) AS FRNM
	            , S.FRDT
	            , S.LMID
	            , S.LMDT
	            , S.LMPID
	
	    FROM FOMM_POST_SW_REQ S
	    INNER JOIN FOMM_POST_DT D
	    ON S.POST_DT_NO = D.POST_DT_NO 
	    WHERE 1=1
	    AND    D.DEL_YN = 'N'
		<if test="POST_DT_NO != '' and POST_DT_NO != null">
		AND S.POST_DT_NO = #{POST_DT_NO}
		</if>
	
		<if test="SDATE != '' and SDATE != null and EDATE != '' and EDATE != null">
		AND SUBSTR(S.FRDT, 0, 8) BETWEEN #{SDATE} AND #{EDATE}
		</if>
    </select>

	<!-- SPP 게시판 템플릿 목록 조회 -->
    <select id="select05" parameterType="java.util.Map" resultType="java.util.Map">
        /* FOMM0251WMapper >> select05 */
        SELECT    '0' AS CHK
                , '' AS ROWFLAG
                , POST_TMPL_ID
                , POST_TMPL_NM
                , POST_TMPL_CD
                , (SELECT fn_getcodevalue('POST_TMPL_CD', t.POST_TMPL_CD, 'KR', 'KR') FROM dual) AS POST_TMPL_CD_NM
                , CONTS
                , USE_YN
                , RMK
                , FRID
                , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = t.FRID) AS FRNM
                , (SELECT DEPT_NM FROM FOMM_USER_MT WHERE USER_ID = t.FRID) AS FR_DEPT_NM
                , FRDT
                , LMID
                , (SELECT USER_NM FROM FOMM_USER_MT WHERE USER_ID = t.LMID) AS LMNM
                , LMDT
                , LMPID
        FROM FOMM_POST_TMPL t
        WHERE 1=1
        <if test="USE_YN != '' and USE_YN != null">
		AND t.USE_YN = #{USE_YN}
		</if>
        <if test="POST_TMPL_ID != '' and POST_TMPL_ID != null">
        AND t.POST_TMPL_ID = #{POST_TMPL_ID}
        </if>
		<if test="POST_TMPL_NM != '' and POST_TMPL_NM != null">
        AND UPPER(t.POST_TMPL_NM) LIKE UPPER('%' || #{POST_TMPL_NM} || '%')
        </if>
        ORDER BY t.POST_TMPL_ID
    </select>

    <!-- SPP 게시글 추가 -->
    <insert id="insert01" parameterType="java.util.Map">
        <selectKey resultType="string" keyProperty="POST_DT_NO" order="BEFORE">
            SELECT TO_NUMBER(NVL(MAX(POST_DT_NO), 0))+1 AS POST_DT_NO   FROM FOMM_POST_DT
        </selectKey>

        /* FOMM0251WMapper >> insert01 */
        INSERT INTO FOMM_POST_DT
        (
              POST_DT_NO
            , POST_MT_TYPE_CD
            , POST_MT_TYPE_NM
            , TITLE
            , CONTS
            , NTC_YN
            , DEL_YN
            , READ_CNT
            , RMK
            , FRID
            , FRDT
            , LMID
            , LMDT
            , LMPID
            , POST_TMPL_ID
            , UP_POST_DT_NO
            , POST_MT_NO
            , SVC_CLSS_CD
            , BSE_LVL2_CD
            , UPMU_ID1
            , UPMU_ID2
            , PL_ID
            , PL_NM
        )
        VALUES
        (
              #{POST_DT_NO}
            , #{POST_MT_TYPE_CD}
            , #{POST_MT_TYPE_NM}
            , #{TITLE}
            , #{CONTS}
            , NVL(#{NTC_YN}, 'N')
            , 'N'
            , 0
            , ''
            , #{FRID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMPID}
            , #{POST_TMPL_ID}
            , #{UP_POST_DT_NO}
            , #{POST_MT_NO}
            , #{SVC_CLSS_CD}
            , #{BSE_LVL2_CD}
            , #{UPMU_ID1} --업무분류1
            , #{UPMU_ID2} --업무분류2
            , #{PL_ID} -- PL 아이디
            , #{PL_NM} -- PL 이름
        )
    </insert>
    
    <!-- SPP 게시판 추가 -->
    <insert id="insert02" parameterType="java.util.Map">
    
        <selectKey resultType="string" keyProperty="POST_MT_NO" order="BEFORE">
            SELECT TO_NUMBER(NVL(MAX(POST_MT_NO), 0))+1 AS POST_MT_NO   FROM FOMM_POST_MT
        </selectKey>

        /* FOMM0251WMapper >> insert02 */
        INSERT INTO FOMM_POST_MT
        (
              POST_MT_NO --게시판번호
            , POST_MT_TYPE_CD --게시판구분코드
            , POST_MT_TYPE_NM --게시판구분명
            , UP_POST_MT_NO --상위게시판번호
            , TITLE --게시판이름
            , BEGIN_DT --게시시작일시
            , END_DT --게시종료일시
            , DEL_YN --삭제여부
            , RMK --비고
            , FRID --최초등록자
            , FRDT --최초등록일시
            , LMID --최종수정자
            , LMDT --최종수정일시
            , LMPID --최종수정화면ID
            , POST_TMPL --템플릿 리스트
            , DEPT_NM --접근부서/팀명
            , DEPT_CD --접근부서/팀코드
            , AUTH_WRITE --쓰기권한(TEAM, ALL)
            , WRITE_GUBUN --쓰기권한 종류(P,C,S)
            , AUTH_READ --읽기권한(TEAM, ALL)
            , ATTACH_YN --첨부권한
            , ALARM_GUBUN --알람 종류(P,C,S)
            , CREATE_TYPE --생성타입
            , MANAGER --관리자
        )
        VALUES
        (
              #{POST_MT_NO}
            , #{POST_MT_TYPE_CD}
            , #{POST_MT_TYPE_NM}
            , #{UP_POST_MT_NO}
            , #{TITLE}
            , NVL2(#{BEGIN_DT}, RPAD(#{BEGIN_DT}, 14, '0'), '')
            , NVL2(#{END_DT}, RPAD(#{END_DT}, 14, '0'), '')
            , 'N'
            , #{RMK}
            , #{FRID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMPID}
            , #{POST_TMPL}
            , #{DEPT_NM}
            , #{DEPT_CD}
            , #{AUTH_WRITE}
            , #{WRITE_GUBUN}
            , #{AUTH_READ}
            , #{ATTACH_YN}
            , #{ALARM_GUBUN}
            , #{CREATE_TYPE}
            , #{MANAGER}
        )
    </insert>


    <!-- SPP SW 게시판 그리드 - 추가 -->
    <insert id="insert03" parameterType="java.util.Map">
        <selectKey resultType="string" keyProperty="SEQ" order="BEFORE">
            SELECT TO_NUMBER(NVL(MAX(SEQ), 0))+1 AS SEQ   FROM FOMM_POST_SW_REQ
        </selectKey>

        /* FOMM0251WMapper >> insert03 */
        INSERT INTO FOMM_POST_SW_REQ
        (
              POST_DT_NO
            , SEQ
            , REQ_USER_ID
            , REQ_DEPT_ID
            , REQ_DEPT_NM
            , SW_NM
            , SW_CNT
            , SW_AMT
            , USE_PURPOSE
            , SW_VENDOR_NM
            , SW_USE_TYPE
            , DEL_YN
            , RMK
            , FRID
            , FRDT
            , LMID
            , LMDT
            , LMPID
        )
        VALUES
        (
              #{POST_DT_NO}
            , #{SEQ}
            , #{REQ_USER_ID}
            , #{REQ_DEPT_ID}
            , #{REQ_DEPT_NM}
            , #{SW_NM}
            , #{SW_CNT}
            , #{SW_AMT}
            , #{USE_PURPOSE}
            , #{SW_VENDOR_NM}
            , #{SW_USE_TYPE}
            , 'N'
            , #{RMK}
            , #{FRID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMPID}
        )
    </insert>

    <!-- SPP IT 게시판 그리드 - 추가 -->
    <insert id="insert04" parameterType="java.util.Map">
        <selectKey resultType="string" keyProperty="SEQ" order="BEFORE">
            SELECT TO_NUMBER(NVL(MAX(SEQ), 0))+1 AS SEQ   FROM FOMM_POST_EDU_REQ
        </selectKey>

        /* FOMM0251WMapper >> insert04 */
        INSERT INTO FOMM_POST_EDU_REQ
        (
              POST_DT_NO
            , SEQ
            , REQ_USER_ID
            , REQ_DEPT_ID
            , REQ_DEPT_NM
            , EDU_TYPE_CD
            , EDU_NM
            , EDU_ORG_NM
            , EDU_CNT_NM
            , EDU_AMOUNT
            , DEL_YN
            , RMK
            , FRID
            , FRDT
            , LMID
            , LMDT
            , LMPID
        )
        VALUES
        (
              #{POST_DT_NO}
            , #{SEQ}
            , #{REQ_USER_ID}
            , #{REQ_DEPT_ID}
            , #{REQ_DEPT_NM}
            , #{EDU_TYPE_CD}
            , #{EDU_NM}
            , #{EDU_ORG_NM}
            , #{EDU_CNT_NM}
            , #{EDU_AMOUNT}
            , 'N'
            , #{RMK}
            , #{FRID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMID}
            , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , #{LMPID}
        )
    </insert>
    
    <!-- SPP 게시판 템플릿 - 추가 -->
    <insert id="insert05" parameterType="java.util.Map">
        <selectKey resultType="string" keyProperty="POST_TMPL_ID" order="BEFORE">
            SELECT TO_NUMBER(NVL(MAX(POST_TMPL_ID), 0))+1 AS POST_TMPL_ID   FROM FOMM_POST_TMPL
        </selectKey>
        
        /* FOMM0251WMapper >> insert05 */
        INSERT INTO FOMM_POST_TMPL
        (
                POST_TMPL_ID
              , POST_TMPL_NM
              , POST_TMPL_CD
              , CONTS
              , USE_YN
              , RMK
              , FRID
              , FRDT
              , LMID
              , LMDT
              , LMPID
        )
        VALUES
        (
                #{POST_TMPL_ID}
              , #{POST_TMPL_NM}
              , #{POST_TMPL_CD}
              , #{CONTS}
              , 'Y'
              , ''
              , #{FRID}
              , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
              , #{LMID}
              , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
              , #{LMPID}
        )
    </insert>

    <!-- SPP 게시글 수정 -->
    <update id="modify01" parameterType="java.util.Map">
        /* FOMM0251WMapper >> modify01 */
        UPDATE FOMM_POST_DT SET
			  TITLE         = #{TITLE}  --제목
			, CONTS         = #{CONTS}  --내용
			, DEL_YN        = #{DEL_YN} --삭제여부
			, NTC_YN        = #{NTC_YN} --공지글여부
			, RMK           = #{RMK}    --비고
			, LMID          = #{LMID}   --최종수정자
			, LMDT          = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  --최종수정일시
			, LMPID         = #{LMPID}  --최종수정화면ID
			, READ_CNT      = #{READ_CNT} --조회수
			, POST_TMPL_ID  = #{POST_TMPL_ID} --템플릿ID
			, SVC_CLSS_CD   = #{SVC_CLSS_CD}
			, BSE_LVL2_CD   = #{BSE_LVL2_CD}
			, UPMU_ID1      = #{UPMU_ID1} --업무분류1
			, UPMU_ID2      = #{UPMU_ID2} --업무분류2
			, PL_ID         = #{PL_ID} -- PL 아이디
			, PL_NM         = #{PL_NM} -- PL 이름
        WHERE POST_DT_NO = #{POST_DT_NO}
    </update>

   
    <!-- SPP 게시판 수정 -->
    <update id="modify02" parameterType="java.util.Map">
        /* FOMM0251WMapper >> modify02 */
        UPDATE FOMM_POST_MT SET
			  TITLE         = #{TITLE}  --제목
			, POST_MT_TYPE_CD   = #{POST_MT_TYPE_CD}
			, BEGIN_DT      = NVL2(#{BEGIN_DT}, RPAD(#{BEGIN_DT}, 14, '0'), '')
			, END_DT        = NVL2(#{END_DT}, RPAD(#{END_DT}, 14, '0'), '')
			, DEL_YN        = #{DEL_YN} --삭제여부
			, RMK           = #{RMK}    --비고
			, LMID          = #{LMID}   --최종수정자
			, LMDT          = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  --최종수정일시
			, LMPID         = #{LMPID}  --최종수정화면ID
			, POST_TMPL = #{POST_TMPL} --템플릿리스트
			, DEPT_NM = #{DEPT_NM} --접근부서/팀명
			, DEPT_CD = #{DEPT_CD} --접근부서/팀코드
			, AUTH_WRITE = #{AUTH_WRITE} --쓰기권한(TEAM, ALL)
			, WRITE_GUBUN = #{WRITE_GUBUN} --쓰기권한 종류(P,C,S)
			, AUTH_READ = #{AUTH_READ} --읽기권한(TEAM, ALL)
			, ATTACH_YN = #{ATTACH_YN} --첨부권한
			, ALARM_GUBUN = #{ALARM_GUBUN} --알람 종류(P,C,S)
			, MANAGER = #{MANAGER} -- 관리자
			, SORT_ORDR = #{SORT_ORDR} -- 정렬순서
		WHERE POST_MT_NO = #{POST_MT_NO}
    </update>

    <!-- SPP SW 게시판 그리드 - 수정 -->
    <update id="modify03" parameterType="java.util.Map">
        /* FOMM0251WMapper >> modify03 */
        UPDATE FOMM_POST_SW_REQ SET
			  SW_NM             = #{SW_NM}
			, SW_CNT            = #{SW_CNT}
			, USE_PURPOSE       = #{USE_PURPOSE}
			, SW_VENDOR_NM      = #{SW_VENDOR_NM}
			, SW_USE_TYPE       = #{SW_USE_TYPE}
			, SW_AMT            = #{SW_AMT}
			, RMK               = #{RMK}
			, LMID              = #{LMID}
			, LMDT              = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, LMPID             = #{LMPID}
		WHERE SEQ = #{SEQ}
    </update>

    <!-- SPP IT 게시판 그리드 - 수정 -->
    <update id="modify04" parameterType="java.util.Map">
        /* FOMM0251WMapper >> modify04 */
        UPDATE FOMM_POST_EDU_REQ SET
			  EDU_TYPE_CD       = #{EDU_TYPE_CD}
			, EDU_NM            = #{EDU_NM}
			, EDU_CNT_NM        = #{EDU_CNT_NM}
			, EDU_AMOUNT        = #{EDU_AMOUNT}
			, RMK               = #{RMK}
			, LMID              = #{LMID}
			, LMDT              = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, LMPID             = #{LMPID}
			, EDU_ORG_NM        = #{EDU_ORG_NM}
		WHERE SEQ = #{SEQ}
    </update>

    <!-- SPP 게시판 템플릿 - 수정 -->
    <update id="modify05" parameterType="java.util.Map">
        /* FOMM0251WMapper >> modify05 */
        UPDATE FOMM_POST_TMPL SET
			  POST_TMPL_NM      = #{POST_TMPL_NM}
			, POST_TMPL_CD      = #{POST_TMPL_CD}
			, CONTS             = #{CONTS}
			, USE_YN            = #{USE_YN}
			, RMK               = #{RMK}
			, LMID              = #{LMID}
			, LMDT              = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, LMPID             = #{LMPID}
        WHERE POST_TMPL_ID = #{POST_TMPL_ID}
    </update>

    <!-- SPP 게시글 삭제 -->
    <update id="remove01" parameterType="java.util.Map">
        /* FOMM0251WMapper >> remove01 */
        UPDATE FOMM_POST_DT SET
			  DEL_YN    = 'Y'       --삭제여부
			, LMID      = #{LMID}   --최종수정자
			, LMDT      = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  --최종수정일시
			, LMPID     = #{LMPID}  --최종수정화면ID
        WHERE     POST_DT_NO = #{POST_DT_NO}
    </update>

    <!-- SPP 게시판 삭제 -->
    <update id="remove02" parameterType="java.util.Map">
        /* FOMM0251WMapper >> remove02 */
        UPDATE FOMM_POST_MT SET
			  DEL_YN    = 'Y'       --삭제여부
			, LMID      = #{LMID}   --최종수정자
			, LMDT      = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  --최종수정일시
			, LMPID     = #{LMPID}  --최종수정화면ID
        WHERE     POST_MT_NO = #{POST_MT_NO}
    </update>

    <!-- SPP SW 게시판 그리드 - 삭제 -->
    <update id="remove03" parameterType="java.util.Map">
        /* FOMM0251WMapper >> remove03 */
        UPDATE FOMM_POST_SW_REQ SET
			  DEL_YN    = 'Y'
			, LMID      = #{LMID}   --최종수정자
			, LMDT      = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  --최종수정일시
			, LMPID     = #{LMPID}  --최종수정화면ID
		WHERE SEQ = #{SEQ}
    </update>

    <!-- SPP IT 게시판 그리드 - 삭제 -->
    <update id="remove04" parameterType="java.util.Map">
        /* FOMM0251WMapper >> remove04 */
        UPDATE FOMM_POST_EDU_REQ SET
			  DEL_YN    = 'Y'
			, LMID      = #{LMID}   --최종수정자
			, LMDT      = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  --최종수정일시
			, LMPID     = #{LMPID}  --최종수정화면ID
		WHERE SEQ = #{SEQ}
    </update>

    <!-- SPP 게시판 조회수 증가 -->
    <update id="updateCnt" parameterType="java.util.Map">
        /* FOMM0251WMapper >> updateCnt */
		UPDATE FOMM_POST_DT SET
			READ_CNT = READ_CNT + 1 
		WHERE POST_DT_NO = #{POST_DT_NO}
    </update>

    <!-- SPP 게시판 템플릿 - 삭제 -->
    <update id="remove05" parameterType="java.util.Map">
        /* FOMM0251WMapper >> remove05 */
        UPDATE FOMM_POST_TMPL SET
			  USE_YN    = 'N'
			, LMID      = #{LMID}   --최종수정자
			, LMDT      = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  --최종수정일시
			, LMPID     = #{LMPID}  --최종수정화면ID
        WHERE POST_TMPL_ID = #{POST_TMPL_ID}
    </update>

    <!-- 권한 체크 -->
    <select id="select06" parameterType="java.util.Map" resultType="java.util.Map">
    	/* FOMM0251WMapper >> select06 */
		SELECT P.POST_MT_NO, P.CREATE_TYPE, 'Y' AS ADMIN_YN 
		FROM FOMM_POST_MT P
		WHERE 1=1
		AND P.DEL_YN != 'Y'
		<if test="USER_ID != '' and USER_ID != null">
            AND P.MANAGER LIKE '%' || #{USER_ID} || '%'
        </if>
        ORDER BY CREATE_TYPE
    </select>
    
</mapper>