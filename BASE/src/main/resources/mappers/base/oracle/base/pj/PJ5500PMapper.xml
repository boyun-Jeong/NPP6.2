<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.base.pj.dao.PJ5500PDAO">

	<select id="select01" parameterType="java.util.Map" resultType="java.util.Map">
		SELECT
			  '0'	AS CHK
			, ''	AS ROWFLAG
			, A.STEST_ID
			, A.STEST_NO
			, A.STEST_TYPE_CD
			, A.STEST_VERSION
			, A.STEST_NAME
			, A.CASE_DESC
			, A.STEP_SEQ
			, A.STEP_NO
			, A.STEP_NAME
			, A.STEP_DESC
			, A.STEP_INPUT
			, A.STEP_EXPECT
			, A.PJT_ID
			, A.BIZ_ID
			, D.BIZ_NAME
			, A.RESULT_CD
			, A.REMARK
			, A.TESTER_ID
			, A.TESTER_NM
			, A.TESTER_DEPT
			, A.TESTER_PDATE
			, A.TESTER_ADATE
			, A.PL_USER_ID
			, A.PL_USER_NM
			, A.PL_USER_DEPT
			, A.PL_TEST_PDATE
			, A.PL_TEST_ADATE
			, A.UPMU_USER_ID
			, A.UPMU_USER_NM
			, A.UPMU_USER_DEPT
			, A.UPMU_TEST_PDATE
			, A.UPMU_TEST_ADATE
			, A.REG_STIME
			, A.REG_USER_ID
			, A.REG_USER_NM
			, A.REG_USER_DEPT
			, A.LMOD_SDATE
			, A.LMOD_USER_ID
			, A.LMOD_USER_NM
			, A.LMOD_USER_DEPT
			, B.PJT_NAME AS PJT_NAME
			, C.PJT_ID   AS P_PJT_ID 
			, C.PJT_NAME AS P_PJT_NAME
		FROM
			  PJ_SCNR_TEST A
			, PJ_PROJECT B   
			, PJ_PROJECT C
			, PJ_BIZ D

		WHERE 1 = 1
		AND A.PJT_ID		= B.PJT_ID
		AND B.PARENT_ID		= C.PJT_ID
		AND A.PJT_ID		= D.PJT_ID
		AND A.BIZ_ID		= D.BIZ_ID
		AND A.PJT_ID		= #{PJT_ID}
		AND A.BIZ_ID		= #{BIZ_ID}
		AND A.STEST_NO		= #{STEST_NO}
		AND A.STEST_TYPE_CD	= #{STEST_TYPE_CD}
		AND A.STEST_VERSION	= #{STEST_VERSION}

		AND A.BIZ_ID	= #{BIZ_ID}
		
		<if test="STYPE != '' and STYPE != null">
			<choose>
				<when test='"FAIL_CNT".equals(SUB_YN)'>
		AND A.RESULT_CD  = 'STEST_RST_CD02'
				</when>
				<when test='"ALL_CNT".equals(SUB_YN)'>
		AND (A.RESULT_CD  = 'STEST_RST_CD02'  OR A.RESULT_CD IS NULL)
				</when>
			</choose>
		</if>

		ORDER BY
			A.STEP_SEQ, A.STEP_NO, A.STEST_ID
	</select>

</mapper>